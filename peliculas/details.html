<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>JJMOVIES - Detalles</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="header">
    <div class="logo">JJMOVIES</div>
    <div class="nav-links">
      <a href="index.html">‚Üê Volver</a>
    </div>
  </header>

  <main class="details-page">
    <div class="details-container">
      <!-- Imagen vertical (cartel) -->
      <div class="details-poster" id="detailsPoster"></div>

      <!-- Informaci√≥n y botones -->
      <div class="details-info">
        <h1 id="detailsTitle"></h1>
        <div class="details-meta">
          <span id="detailsYear"></span> ‚Ä¢ 
          <span id="detailsGenres"></span> ‚Ä¢ 
          <span id="detailsRuntime"></span>
        </div>

        <!-- Botones encima de la sinopsis -->
        <div class="details-actions">
          <button id="playBtn" class="btn-play">‚ñ∂ Ver ahora</button>
          <button id="favoriteBtn" class="btn-info">‚ô° A√±adir a Mi Lista</button>
          <a href="https://t.me/+6MfwQuRHO_Q3NTIx" target="_blank" class="telegram-btn">üí¨ Telegram</a>
        </div>

        <!-- Sinopsis debajo de los botones -->
        <p id="detailsOverview"></p>
      </div>
    </div>
  </main>

  <script src="script.js"></script>
  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const id = urlParams.get('id');
    const type = urlParams.get('type');

    // Cargar detalles
    async function loadDetails() {
      try {
        const url = `${BASE_URL}/${type}/${id}?api_key=${API_KEY}&language=es-ES`;
        const res = await fetch(url);
        const data = await res.json();

        // Mostrar poster grande (vertical)
        const posterUrl = data.poster_path ? IMG_BASE + data.poster_path : "https://via.placeholder.com/400x600/222/aaa?text=Sin+imagen";
        document.getElementById("detailsPoster").style.backgroundImage = `url(${posterUrl})`;

        // T√≠tulo
        document.getElementById("detailsTitle").textContent = data.title || data.name;

        // Metadatos
        document.getElementById("detailsYear").textContent = data.release_date?.substring(0,4) || data.first_air_date?.substring(0,4) || "???";
        document.getElementById("detailsGenres").textContent = data.genres.map(g => g.name).join(", ") || "‚Äî";
        document.getElementById("detailsRuntime").textContent = `${data.runtime || data.episode_run_time?.[0] || 0} min`;

        // Sinopsis
        document.getElementById("detailsOverview").textContent = data.overview;

        // Configurar botones
        document.getElementById("playBtn").onclick = () => window.location.href = `watch.html?id=${id}&type=${type}`;

        const favoriteBtn = document.getElementById("favoriteBtn");
        const isFavorite = myList.some(item => item.id === id && item.type === type);
        favoriteBtn.textContent = isFavorite ? "‚ù§Ô∏è A√±adido" : "‚ô° A√±adir a Mi Lista";
        favoriteBtn.onclick = () => {
          toggleFavorite(null, id, type);
          favoriteBtn.textContent = myList.some(item => item.id === id && item.type === type) ? "‚ù§Ô∏è A√±adido" : "‚ô° A√±adir a Mi Lista";
        };
      } catch (err) {
        console.error("Error al cargar detalles", err);
        document.body.innerHTML = "<h1>Error al cargar los detalles.</h1>";
      }
    }

    if (id && type) {
      loadDetails();
    } else {
      document.body.innerHTML = "<h1>ID o tipo no v√°lido.</h1>";
    }
  </script>
</body>
</html>
